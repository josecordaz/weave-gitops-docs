<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-RD8E3F9BEH","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Weave GitOps" href="/opensearch.xml"><title data-react-helmet="true">Upgrading | Weave GitOps</title><meta data-react-helmet="true" property="og:url" content="https://docs.gitops.weave.works//docs/enterprise/upgrading"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="0.3.1"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-0.3.1"><meta data-react-helmet="true" property="og:title" content="Upgrading | Weave GitOps"><meta data-react-helmet="true" name="description" content="How to: Upgrade to Weave Gitops Enterprise"><meta data-react-helmet="true" property="og:description" content="How to: Upgrade to Weave Gitops Enterprise"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_150px.png"><link data-react-helmet="true" rel="canonical" href="https://docs.gitops.weave.works//docs/enterprise/upgrading"><link data-react-helmet="true" rel="alternate" href="https://docs.gitops.weave.works//docs/enterprise/upgrading" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.gitops.weave.works//docs/enterprise/upgrading" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.2f0d4c62.css">
<link rel="preload" href="/assets/js/runtime~main.a8e4c494.js" as="script">
<link rel="preload" href="/assets/js/main.bf8013af.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Weave GitOps</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Introduction</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/installation">Installation</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Getting Started</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/aws-marketplace">AWS Marketplace</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/intro">0.3.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/enterprise/upgrading">main</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/enterprise/upgrading">0.3.1</a></li><li><a class="dropdown__link" href="/docs/0.3.0/enterprise/upgrading">0.3.0</a></li><li><a class="dropdown__link" href="/docs/0.2.5/intro">0.2.5</a></li><li><a class="dropdown__link" href="/docs/0.2.4/intro">0.2.4</a></li><li><a class="dropdown__link" href="/docs/0.2.2/intro">0.2.2</a></li><li><a class="dropdown__link" href="/docs/0.2.1/intro">0.2.1</a></li><li><a class="dropdown__link" href="/docs/0.2.0/intro">0.2.0</a></li><li><a class="dropdown__link" href="/docs/0.0.5/intro">0.0.5</a></li></ul></div><a href="https://github.com/weaveworks/weave-gitops" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_xXbB"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="Weave GitOps Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Weave GitOps</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/aws-marketplace">AWS Marketplace</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/enterprise/upgrading">main</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/enterprise/upgrading">0.3.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.3.0/enterprise/upgrading">0.3.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.5/intro">0.2.5</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.4/intro">0.2.4</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.2/intro">0.2.2</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.1/intro">0.2.1</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.2.0/intro">0.2.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/0.0.5/intro">0.0.5</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/weaveworks/weave-gitops" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installation">Installing the CLI</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/cli-reference">CLI Reference</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/troubleshooting">Troubleshooting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/aws-marketplace">AWS Marketplace</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Examples</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/examples/sock-shop">Deploying the Sock Shop Application</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/gitops-automation">GitOps Automation Configuration</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cluster management</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/managing-existing-clusters">Managing existing clusters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/cluster-api-providers">Cluster API Providers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/templates">CAPI Templates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/provider-identities">CAPI Provider Identities</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/deleting-a-cluster">Deleting a Cluster</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="-1">CLI Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/cli/cli-clusters">Clusters</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cluster-management/cli/cli-templates">Templates</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Enterprise</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise/intro">Introduction</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/enterprise/upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/enterprise/configuration">Configuration</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="badge badge--secondary">Version: 0.3.1</span><div class="markdown"><header><h1 class="h1Heading_27L5">Upgrading</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-upgrade-to-weave-gitops-enterprise"></a>How to: Upgrade to Weave Gitops Enterprise<a class="hash-link" href="#how-to-upgrade-to-weave-gitops-enterprise" title="Direct link to heading">#</a></h2><p>Upgrading requires we:</p><ol><li>Already have Weave GitOps <a href="/docs/getting-started">installed on the cluster</a></li><li>Install Profiles onto the cluster</li><li>Install the <code>mccp</code> cli tool</li><li>Apply the entitlements secret</li><li>Create a secret for docker repository</li><li>Create a secret for creating pull requests on your git provider</li><li>Upgrade</li><li>Configure</li><li>Check that Weave Gitops Enterprise has been installed</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-install-profiles"></a>2. Install profiles<a class="hash-link" href="#2-install-profiles" title="Direct link to heading">#</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>This step will be removed</h5></div><div class="admonition-content"><p>This step will be removed when Profiles are included in Weave Gitops</p></div></div><p>Download the latest <code>pctl</code> <a href="https://github.com/weaveworks/pctl/releases" target="_blank" rel="noopener noreferrer">release</a> and install the Profile custom resources:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pctl </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> --flux-namespace wego-system</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-install-the-mccp-cli"></a>3. Install the MCCP CLI<a class="hash-link" href="#3-install-the-mccp-cli" title="Direct link to heading">#</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>This step will be removed</h5></div><div class="admonition-content"><p>This step will be removed when the <code>upgrade</code> command moves into the <code>gitops</code> binary</p></div></div><p>The MCCP CLI allows you to <code>upgrade</code> to Weave Gitops Enterprise. You can also use <code>mccp</code> to manage the lifecycle of your infrastructure declaratively using GitOps. The latest version of the MCCP CLI is available in the following links:</p><ul><li><a href="https://s3.amazonaws.com/weaveworks-wkp/releases/mccp-v0.0.10-linux-amd64" target="_blank" rel="noopener noreferrer">Linux</a></li><li><a href="https://s3.amazonaws.com/weaveworks-wkp/releases/mccp-v0.0.10-darwin-amd64" target="_blank" rel="noopener noreferrer">macOS</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="4-apply-the-entitlements-secret"></a>4. Apply the entitlements secret<a class="hash-link" href="#4-apply-the-entitlements-secret" title="Direct link to heading">#</a></h3><p>Contact <a href="mailto:sales@weave.works" target="_blank" rel="noopener noreferrer">sales@weave.works</a> for a valid entitlements secret. Then apply it to the cluster:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f entitlements.yaml</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="5-creating-a-secret-for-docker-repository"></a>5. Creating a secret for docker repository<a class="hash-link" href="#5-creating-a-secret-for-docker-repository" title="Direct link to heading">#</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>This step will be removed</h5></div><div class="admonition-content"><p>This step will be removed when the Docker Image repositories become public</p></div></div><p>Create a secret that contains your docker repository credentials. This secret will be used by Kubernetes during deployment in order to pull down the WGE images. You can find instructions on how to generate this secret <a href="https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/" target="_blank" rel="noopener noreferrer">here</a>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl create secret docker-registry </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace wego-system docker-io-pull-secret </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --docker-username</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your-docker-username</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --docker-password</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your-docker-password</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you use a secrets management solution such as Sealed Secrets follow their instructions on how to create a new secret.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="6-create-a-secret-for-creating-pull-requests-on-your-git-provider"></a>6. Create a secret for creating pull requests on your git provider<a class="hash-link" href="#6-create-a-secret-for-creating-pull-requests-on-your-git-provider" title="Direct link to heading">#</a></h3><p>A Personal Access Token is required for the WGE to create pull requests for new clusters. These tokens need certain permissions (scopes) set. For</p><ul><li>GitHub: <code>repo</code></li><li>GitLab: <code>api</code></li></ul><p>Save the token in secret called <code>git-provider-credentials</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret generic git-provider-credentials </span><span class="token punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --namespace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">wego-system</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --from-literal</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;GIT_PROVIDER_TOKEN=</span><span class="token string variable" style="color:rgb(191, 199, 213)">$GITHUB_TOKEN</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="7-upgrade"></a>7. Upgrade<a class="hash-link" href="#7-upgrade" title="Direct link to heading">#</a></h3><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>This step will change</h5></div><div class="admonition-content"><p>This will change when the <code>upgrade</code> command moves into the <code>gitops</code> binary</p></div></div><p>Run the upgrade command from a local copy of git repo that is sync&#x27;d to the cluster:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> my-cluster-repo</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">mccp upgrade</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>A <strong>Pull Request</strong> will be created against your cluster repository. <strong>Review and merge</strong> this pull request to upgrade to Weave Gitops Enterprise.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="8-configure-weave-gitops-enterprise"></a>8. Configure Weave Gitops Enterprise<a class="hash-link" href="#8-configure-weave-gitops-enterprise" title="Direct link to heading">#</a></h3><p>Weave Gitops Enterprise has a number of configration options but two importants aspect to configure are:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="81-ingress"></a>8.1. Ingress<a class="hash-link" href="#81-ingress" title="Direct link to heading">#</a></h4><p>An Ingress address is necessary in order to establish connectivity between agents and your WGE instance. The way to determine this depends on your cluster type and provisioning method.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">kind clusters</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_1uMI">Other cloud providers</li></ul><div class="margin-vert--md"><div role="tabpanel" hidden=""><p>To determine the public IP address of the worker nodes of your cluster get the local IP for kind:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">INGRESS_ADDRESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable" style="color:rgb(191, 199, 213)">ipconfig getifaddr en0</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><p>For other cluster providers you&#x27;ll have to configure the ingress around what they provide.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">INGRESS_ADDRESS</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">wge.example.com</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div></div></div><p>Update the <code>agentTemplate.natsURL</code> value in the Weave Gitops Enterprise <code>ConfigMap</code> in your config repo.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="82-git-repository-configuration"></a>8.2. Git repository configuration<a class="hash-link" href="#82-git-repository-configuration" title="Direct link to heading">#</a></h4><p>WGE will make pull requests against your git config repo when creating new CAPI clusters etc. The <code>GIT_PROVIDER_TOKEN</code> in the <code>git-provider-credentials</code> secret specified above will be used to authenticate.</p><p>Update the <code>capi.config.repositoryURL</code> with the correct url to your git config repository in the Weave Gitops Enterprise <code>ConfigMap</code> in git config repository itself.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Restart capi-service</h5></div><div class="admonition-content"><p>After configuring values in the <code>ConfigMap</code> you may have to delete the cluster-service pod for the changes to take effect.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="9-checking-that-wge-is-installed"></a>9. Checking that WGE is installed<a class="hash-link" href="#9-checking-that-wge-is-installed" title="Direct link to heading">#</a></h3><p>You should now be able to load the WGE UI by running the following command:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ kubectl port-forward --namespace wego-system deployments.apps/mccp-nginx-ingress-controller </span><span class="token number" style="color:rgb(247, 140, 108)">8000</span><span class="token plain">:80</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The WGE UI should now be accessible at <code>http://localhost:8000</code>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/weaveworks/weave-gitops-docs/edit/main/versioned_docs/version-0.3.1/enterprise/upgrading.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/enterprise/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/enterprise/configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-upgrade-to-weave-gitops-enterprise" class="table-of-contents__link">How to: Upgrade to Weave Gitops Enterprise</a><ul><li><a href="#2-install-profiles" class="table-of-contents__link">2. Install profiles</a></li><li><a href="#3-install-the-mccp-cli" class="table-of-contents__link">3. Install the MCCP CLI</a></li><li><a href="#4-apply-the-entitlements-secret" class="table-of-contents__link">4. Apply the entitlements secret</a></li><li><a href="#5-creating-a-secret-for-docker-repository" class="table-of-contents__link">5. Creating a secret for docker repository</a></li><li><a href="#6-create-a-secret-for-creating-pull-requests-on-your-git-provider" class="table-of-contents__link">6. Create a secret for creating pull requests on your git provider</a></li><li><a href="#7-upgrade" class="table-of-contents__link">7. Upgrade</a></li><li><a href="#8-configure-weave-gitops-enterprise" class="table-of-contents__link">8. Configure Weave Gitops Enterprise</a></li><li><a href="#9-checking-that-wge-is-installed" class="table-of-contents__link">9. Checking that WGE is installed</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Support</div><ul class="footer__items"><li class="footer__item"><a href="mailto:support@weave.works" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Contact Us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Weaveworks</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a8e4c494.js"></script>
<script src="/assets/js/main.bf8013af.js"></script>
</body>
</html>